import rsa

def show_pub():
    public_key = rsa.PublicKey(
        112498960303803422979651245957017678176394995870040805103294101587080573593391639083204890633266176675619193431853787099141105414422882423667306631770369249723135465658112044512157221802265928432962881804577056072295101819125598383697077060226451710050415188411376031025142998028523529220279991750739514313573,
        65537)

    with open("main/components/id_rsa.pub", "w") as text_file:
        text_file.write(public_key.save_pkcs1().decode('ascii'))

def encrypt_text(text):
    public_key = rsa.PublicKey(
        112498960303803422979651245957017678176394995870040805103294101587080573593391639083204890633266176675619193431853787099141105414422882423667306631770369249723135465658112044512157221802265928432962881804577056072295101819125598383697077060226451710050415188411376031025142998028523529220279991750739514313573,
        65537)

    return rsa.encrypt(text.encode('utf-8'), public_key)


def decrypt_text(text):
    private_key = rsa.PrivateKey(
        112498960303803422979651245957017678176394995870040805103294101587080573593391639083204890633266176675619193431853787099141105414422882423667306631770369249723135465658112044512157221802265928432962881804577056072295101819125598383697077060226451710050415188411376031025142998028523529220279991750739514313573,
        65537,
        105447283710001075273768960860180340154382535076380313665414244875303607966010879308515696884369256557465423094211610047959762645567896675213375280193289259049092936107215782160567594079636645826370084812987772047467355184725660283080559902959834837970395201605225355306389304916421074345038498157674905654849,
        54453017540102265780646638375551174180003890177362990355713586730600416440846304363001426226348768572416670612076076652749216088278275907163150413683821572899626257,
        2065982114231830387299732653224934901379717480127255306258576080846591437822426986786972962852398835442014904792579660792165834204952404168743189)
    return str((rsa.decrypt(text, private_key)).decode('utf-8'))
